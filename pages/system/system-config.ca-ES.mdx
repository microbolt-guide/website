import { Callout,Steps,Tabs } from 'nextra/components'

# Configuraci贸 del sistema

Ara esteu a la l铆nia d'ordres del vostre propi node Bitcoin. Comencem amb la
configuraci贸.

## Valors per defecte

Aquesta guia no t茅 cap valor predeterminat en ment, podeu triar les eines que
vulgueu

<Callout type="info">
Tot i aixi, desde MicroBolt recomanem `EDITOR=vi` i `SU=doas`
</Callout>

<Steps>
### Definiu quin **editor de text** i **eina d'escalada de privilegis** voleu

Afegiu en un fitxer de configuraci贸 de perfil, substitu茂u `<...>` per la vostra
pr貌pia elecci贸

```sh
printf "%s\n" \
    "export EDITOR=<notepad,vi,vim,neovim,nano,micro,emacs...>" \
    "export SU=<sudo,doas,ssu...>" \
    > /etc/profile.d/defaults.sh
```

### Aplica els canvis

```sh copy
. /etc/profile.d/defaults.sh
```

### Instal路leu

<Callout type="warning">
La vostra elecci贸 pot necessitar passos addicionals, 茅s la vostra
responsabilitat
</Callout>

```sh copy
apk add $EDITOR $SU
```
</Steps>

## Afegeix l'usuari administrador

Utilitzarem l'usuari principal `satoshi` en comptes de `root` per fer que
aquesta guia sigui m茅s universal.

<Steps>
### Creeu un usuari nou anomenat `satoshi` amb la vostra `contrasenya [A]`

```sh copy
adduser satoshi
```

### Fes d'aquest nou usuari un superusuari afegint-lo al grup d'usuaris `wheel`

```sh copy
adduser satoshi wheel
```

### Permet als membres del grup **wheel** utilitzar privilegis de root amb `$SU`

<Tabs items={['doas', 'sudo', 'ssu']}>
    <Tabs.Tab>
```sh copy
sed 's/# permit persist :wheel/permit persist keepenv :wheel/' /etc/doas.conf > _
mv -f _ /etc/doas.conf
```
    </Tabs.Tab>
    <Tabs.Tab>
```sh copy
printf "%s\n" \
    "%wheel ALL=(ALL) ALL" \
    "Defaults env_keep += \"*\"" \
    > /etc/sudoers.d/wheel
```
    </Tabs.Tab>
    <Tabs.Tab>
<Callout type="warning">
     Work in progress 
</Callout>
    </Tabs.Tab>
</Tabs>

### Tancar sessi贸

```sh copy
exit
```

### Inicieu sessi贸 amb l'usuari administrador `satoshi`

```sh copy
ssh satoshi@nakamoto01
```
</Steps>

## Actualitzaci贸 del sistema

* Habilita el repositori **comunitat**

```sh copy
$SU $EDITOR /etc/apk/repositories
```

* Descomenteu la seg眉ent l铆nia

```conf filename="/etc/apk/repositories" {3}
#/media/usb/apks
http://dl-cdn.alpinelinux.org/alpine/v3.19/main
http://dl-cdn.alpinelinux.org/alpine/v3.19/community
```

<Callout type="info">
Feu-ho regularment cada poques setmanes/mesos per obtenir actualitzacions
relacionades amb la seguretat.
</Callout>

<Steps>
### Actualitzeu el sistema operatiu i tots els paquets de programari instal路lats

```sh copy
$SU apk update
```

### Actualitzeu el Alpine Package Manager

```sh copy
$SU apk add --upgrade apk-tools
```

### Actualitza tots els paquets instal路lats

```sh copy
$SU apk upgrade --available
```
</Steps>

<Callout type="info">
Tots els serveis que s'han actualitzat s'han de reiniciar per comen莽ar a
utilitzar la versi贸 actualitzada

```sh copy
$SU rc-service <service> restart
```

Si s'actualitza el nucli, cal que es reinici茂 per comen莽ar a utilitzar la versi贸
actualitzada

```sh copy
sync && reboot
```
</Callout>

## Comproveu el rendiment de la unitat de disc

s essencial per al node un emmagatzematge amb un cert rendiment.

Comprovem si la vostra unitat funciona b茅 tal com est.

* El vostre disc s'hauria de detectar com a `/dev/<drive>`. Comproveu si aquest
茅s el cas enumerant els noms dels dispositius de bloc connectats

```sh copy
blkid
```

* Instal路leu el programari per mesurar el rendiment del vostre \<drive\>

```sh copy
$SU apk add hdparm
```

* Mesureu la velocitat de la vostra unitat

```sh copy
$SU hdparm -t --direct /dev/<drive>
```

```output filename="output"
/dev/sda:
 Timing O_DIRECT disk reads: 690 MB in  3.00 seconds = 229.82 MB/sec
```

<Callout type="info">
Si les velocitats mesurades s贸n superiors a 150 MB/s, est b茅
</Callout>
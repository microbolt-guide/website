import { Callout, Tabs } from 'nextra/components'

export function FAQBox({ title, children }) {
  return (
    <details
      class="nx-my-4 nx-p-2 nx-rounded nx-border nx-border-gray-200 nx-bg-white dark:nx-border-neutral-800 dark:nx-bg-neutral-900"
    >
      <summary>
        <strong class="text-lg">
          {title}
        </strong>
      </summary>
      <div class="nx-p-2">
        {children}
      </div>
    </details>
  )
}

# Aplicaci贸 de signatura d'escriptori

Instal路lem [Sparrow Wallet](https://github.com/sparrowwallet/sparrow) en un
ordinador i el connectem al vostre servidor Electrum del vostre node per a
transaccions privades de bitcoins on-chain.

![Sparrow wallet](/img/bitcoin/desktop-signing-app/sparrow.webp)

## Introducci贸

Sparrow Wallet 茅s un excel路lent dispositiu de signatura de programari per
utilitzar amb el vostre MicroBolt: 茅s fiable i mostra de manera transparent qu猫
est fent sota el cap贸.

Tamb茅 podeu utilitzar les alternatives seg眉ents en lloc de Sparrow Wallet,
segons les vostres prefer猫ncies i necessitats:

* **Electrum Wallet Desktop**: una cartera d'usuari avan莽ats ben establerta
* **Specter Desktop**: una cartera centrada en m煤lti-signatura (aquesta cartera
es connecta directament a Bitcoin Core)
* **BitBoxApp**: cartera per als usuaris de dispositius de signatura de
maquinari BitBox

Connectarem Sparrow Wallet al nostre propi servidor Electrum ja que 茅s l'opci贸
m茅s privada. Per obtenir m茅s informaci贸 sobre les compensacions entre privadesa
i seguretat de les diferents opcions de connexi贸 del servidor, llegiu el seg眉ent
[article](https://www.sparrowwallet.com/docs/best-practices.html) de Craig Raw,
l'autor del programari.

![Etapes d'Sparrow](/img/bitcoin/desktop-signing-app/sparrow-stages.webp)

Configurarem Sparrow per connectar-se al servidor Electum dins de la vostra
xarxa local. Tamb茅 hi ha una secci贸 opcional que explica com connectar Sparrow
al servidor Electrum mitjan莽ant Tor quan esteu en remot.

Sparrow tamb茅 es connecta a un parell de serveis externs per obtenir el preu de
Bitcoin i comunicar-se amb el servidor Whirlpool durant les operacions de
CoinJoin. De manera predeterminada, utilitza clearnet que filtra l'adre莽a IP del
vostre ordinador a aquests serveis i degrada la vostra privadesa. Tanmateix,
Sparrow tamb茅 es pot connectar amb ells mitjan莽ant un servidor intermediari Tor.
Hi ha una secci贸 opcional que explica com configurar aquest servidor
intermediari.

## Instal路laci贸

Al vostre ordinador local, descarregueu, verifiqueu i instal路leu Sparrow Wallet.

* Utilitzant les instruccions d'[aquesta
pgina](https://www.sparrowwallet.com/download):
   * Baixeu la versi贸 necessria per al vostre sistema operatiu
   * Baixeu els fitxers de signatura del manifest i del manifest
   * Verifiqueu el release
   * Instal路leu Sparrow Wallet

## Connexi贸

Ara configurem Sparrow perqu猫 es connecti al vostre node dins de la vostra xarxa
local.

### Llan莽eu Sparrow

* Llan莽eu Sparrow
* Llegiu atentament els missatges introductoris i feu clic a "Next" diverses
vegades
* Quan arribeu al missatge "Connecting to a Private Electrum Server", feu clic a
"Configure Server"

### Connecteu-vos al servidor Electrum

* Feu clic a la pestanya "Private Electrum".
* A la l铆nia "URL", enganxeu `nakamoto01`, `nakamoto01.local` o la vostra IP del
node (p. ex., `192.168.X.Y`) al primer quadre i `50002` al segon quadre
* Activeu SSL fent clic al control lliscant
* Feu clic a "Test Connection". Hauria d'apar猫ixer una marca verda al bot贸 i
haur铆eu de veure alguna cosa semblant a la sortida seg眉ent:

```output filename="output"
Connected to [...] on protocol version 1.4
[...]
```

![Sparrow connecta a Electrum](/img/bitcoin/desktop-signing-app/sparrow-electrum-no-proxy.webp)

Si hi ha un missatge d'error de connexi贸, proveu la resoluci贸 de problemes
seg眉ent:

* Assegureu-vos que el vostre ordinador no estigui connectat a cap xarxa WiFi de
"convidats" de casa. Una xarxa WiFi de "convidats" impedeix que l'ordinador es
connecti a qualsevol altre dispositiu de la xarxa local, com ara el vostre node.
* Si ja heu utilitzat Sparrow Wallet en aquest ordinador, proveu de
connectar-vos de nou despr茅s d'eliminar els certificats existents que
s'emmagatzemen a la carpeta `certs`:

<Tabs items={['windows', 'unix/linux']}>
    <Tabs.Tab>
`%AppData%\Sparrow\certs`
    </Tabs.Tab>
    <Tabs.Tab>
`~/.sparrow/certs`
    </Tabs.Tab>
</Tabs>

Tornem a l'aplicaci贸 de signatura i comprovem que est connectada al nostre
propi servidor Electrum.

* Tanqueu la finestra de configuraci贸 del servidor
* Comproveu la icona a l'extrem inferior dret de la icona d'estat de la finestra
  * La icona hauria de ser un bot贸 lliscant blau i s'hauria de mostrar el
seg眉ent en passar el ratol铆

`Connected to ssl://nakamoto01:50002 at height [...]`

 Ests preparat! Ara Sparrow est configurat per connectar-se al vostre
servidor Electrum des de la vostra xarxa local.

<Callout type="info">
Per obtenir la mxima privadesa, us recomanem que configureu el servidor
intermediari Tor quan utilitzeu Sparrow a la vostra xarxa local a trav茅s de
Clearnet.
</Callout>

<FAQBox title="Acc茅s remot per Tor">
Si voleu utilitzar Sparrow fora de la vostra xarxa dom猫stica, quan esteu en
remot, podeu utilitzar una connexi贸 a trav茅s de Tor.

{<h3>Adre莽a Tor del servidor</h3>}

Per connectar-se mitjan莽ant Tor a Electrum, el servidor ha de tenir una adre莽a
de connexi贸 de servei oculta Tor. Assegureu-vos que heu configurat un servei
ocult Tor tal com s'explica a la guia "Servidor Electrum".

Si ja heu configurat el servei ocult per貌 heu perdut l'adre莽a de connexi贸, podeu
tornar-la a obtenir executant l'ordre seg眉ent al vostre node:

```sh copy
$SU cat /var/lib/tor/electrum/hostname
```

```output filename="output"
abcd...1234.onion
```

{<h3>Configuraci贸 d'Sparrow</h3>}

* Obre Sparrow
* Navegueu a la pgina de configuraci贸 del servidor prement `<Ctrl><P>` o
`<Cmd><,>` a macOS i, a continuaci贸, feu clic a "Server".
* Feu clic a la pestanya "Private Electrum". Si ja teniu una connexi贸 Clearnet
existent, feu clic a "Edit Existing Connection".
* A la l铆nia "URL", enganxeu la vostra adre莽a de connexi贸 de servei oculta de
Tor (p.ex., "abcd...1234.onion") a la primera casella i `50002` a la segona.
* Activeu SSL fent clic al control lliscant
* Feu clic a "Test Connection". Hauria d'apar猫ixer una marca verda al bot贸 i
haur铆eu de veure alguna cosa semblant a la sortida seg眉ent:

```output filename="output"
Connected to [...] on protocol version 1.4
[...]
```

![Sparrow es connecta a Electrum a trav茅s de Tor](/img/bitcoin/desktop-signing-app/sparrow-electrum-tor-no-proxy.webp)

 Ests preparat! Ara Sparrow est configurat per connectar-se al vostre node a
trav茅s de Tor i podeu utilitzar-lo all on siguis.
</FAQBox>

<FAQBox title="Configureu un servidor intermediari Tor per a serveis externs">
Si es configura un servidor intermediari Tor a Sparrow, totes les connexions
externes utilitzen Tor. Aix貌 inclou l'obtenci贸 de tarifes, coinjoin, etc., fins
i tot la transmissi贸 de transaccions es fa mitjan莽ant un servei extern (com
blockstream.info) a Tor per obtenir m茅s privadesa. Sempre que sigui possible,
s'utilitzen els URL onion d'aquests serveis.

Sparrow es pot configurar per utilitzar un servidor intermediari Tor intern
(empaquetat) o extern. Per utilitzar el servidor intermediari intern, s'ha
d'especificar un URL del servidor onion Electrum i l'opci贸 "Use Proxy" ha
d'estar desactivada. Per tant, la secci贸 seg眉ent nom茅s s'aplica si us connecteu
al vostre servidor Electrum mitjan莽ant l'adre莽a IP local de la vostra xarxa
local (p.ex., `nakamoto01`, `nakamoto01.local` o `192.168.X.Y`). Si utilitzeu
una adre莽a Tor onion per connectar-vos al vostre node, llavors Sparrow ja est
utilitzant el servidor intermediari intern i no hi ha res m茅s a fer!

Si utilitzeu una connexi贸 local, us recomanem que configureu aquest servidor
intermediari Tor extern tal com es descriu a continuaci贸 per obtenir la mxima
privadesa.

{<h3>Preparatius al vostre ordinador</h3>}

Perqu猫 Sparrow Wallet es connecti als serveis externs mitjan莽ant Tor, Tor s'ha
d'executar al vostre ordinador. Podeu executar el navegador Tor i utilitzar el
port 9150 a localhost o b茅 executar Tor com a servei de fons i utilitzar el port
9050.

Aqu铆, utilitzarem el Tor com a servei de fons i el port 9050, ja que 茅s m茅s
fcil i senzill de configurar.

<Tabs items={['windows', 'macOS', 'linux']}>
    <Tabs.Tab>
Per solucionar-ho, primer, assegureu-vos que Tor estigui instal路lat i funcionant
al vostre Windows. Executeu com a administrador:

<Callout type="warning">
Primer heu d'instal路lar [chocolatey](https://chocolatey.org/install)
</Callout>

```sh copy
choco install tor
tor --service start
```

Comproveu que el servei funcioni

```sh copy
netstat -aon | findstr ":9050"
```

```output filename="output"
  TCP    127.0.0.1:9050         0.0.0.0:0              LISTENING       23656
```
    </Tabs.Tab>
    <Tabs.Tab>
Per solucionar-ho, primer, assegureu-vos que Tor estigui instal路lat i en
funcionament al vostre Mac:

<Callout type="warning">
Primer heu d'instal路lar [homebrew](https://brew.sh/)
</Callout>

```sh copy
brew install tor && brew services start tor
```
    </Tabs.Tab>
    <Tabs.Tab>
Hi ha innombrables distribucions de Linux, per貌 les instruccions per a algunes
de les fam铆lies Linux m茅s notables s贸n:

* Alpine-based OS: `apk add tor` i `rc-service tor start`
* Gentoo-based OS: `emerge net-vpn/tor` i `rc-service tor start`
* openSUSE-based OS: `zypper install tor` i `systemctl start tor`
* RedHat-based OS: `yum install tor` i `systemctl start tor`
* Debian-based OS: `apt install tor` i `systemctl start tor`

Fet
    </Tabs.Tab>
</Tabs>

{<h3>Configuraci贸 de l'aplicaci贸 de signatura</h3>}

* Obre Sparrow
* Navegueu a la pgina de configuraci贸 del servidor prement `<Ctrl><P>` o
`<Cmd><,>` a macOS i, a continuaci贸, feu clic a "Server"
* Feu clic a la pestanya "Private Electrum". Si ja teniu una connexi贸 clearnet
existent, feu clic a "Edit Existing Connection".
* Habiliteu el servidor intermediari Tor fent clic al control lliscant "Use
proxy".
* A la l铆nia "Proxy URL", enganxeu `127.0.0.1` al primer quadre i `9050` al
segon quadre.
* Feu clic a "Test Connection". Hauria d'apar猫ixer una marca verda al bot贸 i
haur铆eu de veure alguna cosa semblant a la sortida seg眉ent:

```output filename="output"
Connected to [...] on protocol version 1.4
[...]
```

![s del servidor intermediari del dimoni Tor](/img/bitcoin/desktop-signing-app/sparrow-tor-proxy.webp)

Ara, tornem a l'aplicaci贸 de signatura i comprovem que el servidor intermediari
funciona correctament.

* Tanqueu la finestra de configuraci贸 del servidor
* Comproveu les dues icones a l'extrem inferior dret de les icones d'estat de la
finestra de l'applicaci贸 de signatura
  * La primera icona ha de ser grisa, no vermella; i el ratol铆 hauria de mostrar
"External Tor proxy enabled"

 Ests preparat! Sparrow Wallet ara est configurat per utilitzar el servidor
intermediari Tor quan obteniu el preu de Bitcoin i quan es comuniqui amb el
servidor Whirlpool durant CoinJoins.
</FAQBox>

## Sparrow en acci贸

Enhorabona, ara tens una aplicaci贸 de signatura d'escriptori de Bitcoin, capa莽
de protegir les teves claus de bitcoins, que funciona amb el teu propi node
complet de Bitcoin sense confian莽a!

Sparrow 茅s una potent aplicaci贸 de signatura que us permet utilitzar les
funcions m茅s avan莽ades per protegir les vostres claus bitcoin i preservar la
vostra privadesa.

Amb Sparrow pots:

* Connecteu qualsevol dispositiu de signatura de maquinari
* "Enviar" i "rebre" bitcoins
* Tingueu un control total durant tot el proc茅s de creaci贸 i signatura de
transaccions: control de monedes, PSBT, etiquetatge, visualitzador de
transaccions a nivell de bytes...
* Creeu transaccions per lots per estalviar en les tarifes dels miners
* Creeu multisig per millorar la seguretat
* Uniu les vostres monedes per millorar la privadesa amb Coinjoin
* Analitzeu les vostres accions amb l'explorador de cadena de blocs integrat

Per obtenir m茅s informaci贸, tutorials i suport, visiteu la documentaci贸 de
Sparrow [pgina web](https://sparrowwallet.com/docs) i el seu
[grup](https://t.me/sparrowwallet) de Telegram.

## Per al futur: actualitzaci贸 d'Sparrow

Sparrow us notificar automticament quan hi hagi una actualitzaci贸 disponible.
Simplement instal路leu les actualitzacions utilitzant el m猫tode habitual per al
vostre sistema operatiu.